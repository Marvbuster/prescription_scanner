<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prescription Scanner - Beispiel</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0a0a0a;
      color: #fff;
      margin: 0;
      padding: 40px 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 500px;
      margin: 0 auto;
      text-align: center;
    }
    h1 {
      font-size: 28px;
      margin-bottom: 8px;
    }
    .subtitle {
      color: #888;
      margin-bottom: 40px;
    }
    #scanner-btn {
      margin-bottom: 40px;
    }
    .results {
      text-align: left;
      background: #1a1a1a;
      border-radius: 12px;
      padding: 20px;
    }
    .results h2 {
      font-size: 16px;
      margin: 0 0 16px 0;
      color: #888;
    }
    .result-item {
      background: #252525;
      border-radius: 8px;
      padding: 12px 16px;
      margin-bottom: 8px;
    }
    .result-format {
      display: inline-block;
      background: #2563eb;
      color: #fff;
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 4px;
      margin-bottom: 8px;
    }
    .result-data {
      font-family: monospace;
      font-size: 14px;
      word-break: break-all;
    }
    .result-time {
      font-size: 11px;
      color: #666;
      margin-top: 8px;
    }
    .empty {
      color: #555;
      text-align: center;
      padding: 40px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Prescription Scanner</h1>
    <p class="subtitle">DataMatrix, QR-Code, Code128, Code39</p>

    <!-- Hier wird der Button eingefügt -->
    <div id="scanner-btn"></div>

    <!-- Ergebnisse -->
    <div class="results">
      <h2>Gescannte Codes</h2>
      <div id="results">
        <div class="empty">Noch keine Codes gescannt</div>
      </div>
    </div>
  </div>

  <!-- Prescription Scanner laden -->
  <script type="module">
    import { PrescriptionScanner } from './dist/index.js';

    const results = [];
    const resultsEl = document.getElementById('results');

    // Scanner erstellen
    const scanner = new PrescriptionScanner({
      title: 'Rezept scannen',
      buttonText: 'Scanner öffnen',
      closeOnScan: false,

      onScan: (result) => {
        console.log('Gescannt:', result);

        // Ergebnis speichern
        results.unshift({
          ...result,
          time: new Date().toLocaleTimeString()
        });

        // UI updaten
        renderResults();
      },

      onError: (error) => {
        console.error('Fehler:', error);
        alert('Fehler: ' + error.message);
      }
    });

    // Button erstellen
    scanner.createButton(document.getElementById('scanner-btn'));

    // Ergebnisse rendern
    function renderResults() {
      if (results.length === 0) {
        resultsEl.innerHTML = '<div class="empty">Noch keine Codes gescannt</div>';
        return;
      }

      resultsEl.innerHTML = results.map(r => `
        <div class="result-item">
          <span class="result-format">${r.format}</span>
          <div class="result-data">${r.data}</div>
          <div class="result-time">${r.time}</div>
        </div>
      `).join('');
    }
  </script>
</body>
</html>
